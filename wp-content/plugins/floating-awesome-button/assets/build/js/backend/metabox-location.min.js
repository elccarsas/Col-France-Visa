(()=>{"use strict";var e={};(()=>{var t=e;Object.defineProperty(t,"__esModule",{value:!0}),window.FAB_METABOX_LOCATION=Object.assign(Object.assign({},window.FAB_METABOX_LOCATION),{defaultOptions:Object.assign(Object.assign({},window.FAB_METABOX_LOCATION.defaultOptions),{select2:{placeholder:"--choose--"},type:[],post_types:[]}),init:()=>{jQuery("#post").on("submit",function(){let e=window.FAB_METABOX_LOCATION.check_invalid_rules();if(1==jQuery("#fab-location-rules .fab-location-rule-item").length&&e){let e=jQuery("#fab-location-rules .fab-location-rule-item").last();return jQuery('.select2[name="fab_location_type[]',e).val(""),jQuery('.select2[name="fab_location_type[]',e).trigger("change"),jQuery('.select2[name="fab_location_operator[]',e).val(""),jQuery('.select2[name="fab_location_operator[]',e).trigger("change"),jQuery('.select2[name="fab_location_value[]',e).val(""),jQuery('.select2[name="fab_location_value[]',e).trigger("change"),jQuery('.select2[name="fab_location_logic[]',e).val(""),jQuery('.select2[name="fab_location_logic[]',e).trigger("change"),!0}return e&&jQuery.dialog({icon:"fas fa-times",closeIcon:!0,animation:"scale",columnClass:"j-small",title:"Error",content:"Please check input, there are invalid location rules!"}),!e})},init_type_options:()=>{let e=window.FAB_METABOX_LOCATION.post_types;e=(e=Object.keys(e).sort().map(function(t,a){return{id:t,text:e[t].label}})).filter(function(e,t){return!window.FAB_METABOX_LOCATION.excludes_post_types.includes(e.id)});let t=window.FAB_METABOX_LOCATION.post_taxonomies;t=Object.keys(t).sort().map(function(e,a){return{id:e,text:t[e].labels.name}}),window.FAB_METABOX_LOCATION.defaultOptions.post_types=e,window.FAB_METABOX_LOCATION.defaultOptions.type=[...window.FAB_METABOX_LOCATION.defaultOptions.type,{text:"Post",children:[{id:"post_type",text:"Post Type"},...e.map(function(e,t){let a=e.text.substr(e.text.length-1);return a="s"===a?e.text.substring(0,e.text.length-1):e.text,{id:`single_${e.id}`,text:`Single ${a}`}})]},{text:"Taxonomy",children:[...t.map(function(e,t){return{id:`taxonomy_${e.id}`,text:`${e.text} (${e.id})`}})]},{text:"User",children:[{id:"user_session",text:"Session"},{id:"user_role",text:"Role"}]}]},check_invalid_rules:()=>{let e=!1;return jQuery("#fab-location-rules .fab-location-rule-item").each(function(){let t;return(t=jQuery('.select2[name="fab_location_type[]',this)).val()&&(t=jQuery('.select2[name="fab_location_operator[]',this)).val()&&(t=jQuery('.select2[name="fab_location_value[]',this)).val()&&(t=jQuery('.select2[name="fab_location_logic[]',this)).val()?void 0:(e=!0,!1)}),e},reloadSelect2:(e,t)=>{t.selectedValue||(t.selectedValue=e.val()),e.data("select2")&&(e.select2("destroy"),e.html("")),e.select2(t),e.val(t.selectedValue),e.trigger("change")},getComparatorOption:(e,t)=>(void 0!==e&&e&&("post_type"===e?t.data=window.FAB_METABOX_LOCATION.defaultOptions.post_types:e.includes("taxonomy_")?t.ajax=window.FAB_METABOX_LOCATION.getComparatorOptionTaxonomyTermAjax(e):"user_session"===e?t.data=[{id:"user_session_logged_in",text:"Logged In"}]:"user_role"===e?t.data=window.FAB_METABOX_LOCATION.defaultOptions.user.roles:e.includes("single_")&&(t.ajax=window.FAB_METABOX_LOCATION.getComparatorOptionSingleAjax(e))),t),getComparatorOptionSingleAjax:e=>({delay:500,dataType:"json",url:t=>{e=e.replace("single_","");let a=window.FAB_METABOX_LOCATION.post_types[e].rest_base;return a=a||e,a+=window.FAB_PLUGIN.isNumeric(t.term)?`/${t.term}`:"",`${window.FAB_METABOX_LOCATION.rest_url}wp/v2/${a}`},data:e=>{let t={_fields:"id,title"};return window.FAB_PLUGIN.isNumeric(e.term)||(t=Object.assign(Object.assign({},t),{filter:{post_status:"publish,private"},page:e.page||1,search:e.term,orderby:"title",order:"asc"})),window.FAB_METABOX_LOCATION.ajax_params=t,t},processResults:function(e){let t={more:!1};return window.FAB_METABOX_LOCATION.ajax_params.page<this._request.getResponseHeader("X-WP-TotalPages")&&(t.more=!0),Array.isArray(e)||(e=[e]),{results:e=e.map(function(e,t){return{id:e.id,text:e.title.rendered.replace(/[^\w\s]/gi,"")}}),pagination:t}}}),getComparatorOptionTaxonomyTermAjax:e=>({delay:500,dataType:"json",url:t=>{e=e.replace("taxonomy_","");let a=window.FAB_METABOX_LOCATION.post_taxonomies[e].rest_base;return a=a||e,a+=window.FAB_PLUGIN.isNumeric(t.term)?`/${t.term}`:"",`${window.FAB_METABOX_LOCATION.rest_url}wp/v2/${a}`},data:e=>{let t={};return window.FAB_PLUGIN.isNumeric(e.term)||(t={page:e.page||1,per_page:10,search:e.term}),window.FAB_METABOX_LOCATION.ajax_params=t,t},processResults:function(e){let t={more:!1};return window.FAB_METABOX_LOCATION.ajax_params.page<this._request.getResponseHeader("X-WP-TotalPages")&&(t.more=!0),{results:e=e.map(function(e,t){return{id:e.id,text:e.name.replace(/[^\w\s]/gi,"")}}),pagination:t}}})})})()})();